-- Task 6: Implement Partitioning

-- Partition the Booking table by start_date (monthly partitions)
ALTER TABLE Booking PARTITION BY RANGE (YEAR(start_date)) (
    PARTITION p2023 VALUES LESS THAN (2024),
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- Partition the Payment table by payment_date (quarterly partitions)
ALTER TABLE Payment PARTITION BY RANGE (YEAR(payment_date)) (
    PARTITION p2023_q1 VALUES LESS THAN (2023-04-01),
    PARTITION p2023_q2 VALUES LESS THAN (2023-07-01),
    PARTITION p2023_q3 VALUES LESS THAN (2023-10-01),
    PARTITION p2023_q4 VALUES LESS THAN (2024-01-01),
    PARTITION p2024_q1 VALUES LESS THAN (2024-04-01),
    PARTITION p2024_q2 VALUES LESS THAN (2024-07-01),
    PARTITION p2024_q3 VALUES LESS THAN (2024-10-01),
    PARTITION p2024_q4 VALUES LESS THAN (2025-01-01),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- Query to show partition information
SELECT TABLE_NAME, PARTITION_NAME, TABLE_ROWS, AVG_ROW_LENGTH, DATA_LENGTH
FROM INFORMATION_SCHEMA.PARTITIONS
WHERE TABLE_NAME IN ('Booking', 'Payment')
ORDER BY TABLE_NAME, PARTITION_NAME;
